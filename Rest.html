<!DOCTYPE html>
<html>
<head>
  <title>Menu do Restaurante</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <style>
    .container {
      margin-top: 50px;
    }
    
    .card {
      margin-bottom: 20px;
    }
    
    .card-header {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Menu do Restaurante</h1>
    
    <div class="card">
      <div class="card-header">
        Adicionar Item
      </div>
      <div class="card-body">
        <form id="create-form">
          <div class="form-group">
            <label for="nome">Nome:</label>
            <input type="text" class="form-control" id="nome" required>
          </div>
          <div class="form-group">
            <label for="descricao">Descrição:</label>
            <input type="text" class="form-control" id="descricao" required>
          </div>
          <div class="form-group">
            <label for="preco">Preço:</label>
            <input type="number" class="form-control" id="preco" step="0.01" required>
          </div>
          <button type="submit" class="btn btn-primary">Adicionar</button>
        </form>
      </div>
    </div>
    
    <div class="card">
      <div class="card-header">
        Itens do Menu
      </div>
      <div class="card-body">
        <table id="menu-table" class="table table-striped">
          <thead>
            <tr>
              <th>ID</th>
              <th>Nome</th>
              <th>Descrição</th>
              <th>Preço</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>
  
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script>
    // Função para fazer uma requisição GET à API e preencher a tabela com os dados do menu
// Função para fazer uma requisição GET à API e preencher a tabela com os dados do menu
function populateMenuTable() {
  $.ajax({
    url: 'http://localhost:5502/api/menu/', // Alterado para a URL correta da sua API Spring Boot
    method: 'GET',
    dataType: 'json',
    success: function(data) {
      const tableBody = $('#menu-table tbody');
      tableBody.empty(); // Limpa a tabela antes de preenchê-la novamente
      
      data.forEach(item => {
        const row = `
          <tr>
            <td>${item.id}</td>
            <td>${item.nome}</td>
            <td>${item.descricao}</td>
            <td>${item.preco}</td>
            <td>
              <button onclick="editItem(${item.id})" class="btn btn-sm btn-primary">Editar</button>
              <button onclick="deleteItem(${item.id})" class="btn btn-sm btn-danger">Excluir</button>
            </td>
          </tr>
        `;
        
        tableBody.append(row);
      });
    }
  });
}

// Função para fazer uma requisição POST à API e adicionar um novo item ao menu
function addItem(event) {
  event.preventDefault();
  
  const nome = $('#nome').val();
  const descricao = $('#descricao').val();
  const preco = parseFloat($('#preco').val());
  
  const newItem = {
    nome: nome,
    descricao: descricao,
    preco: preco
  };
  
  $.ajax({
    url: 'http://localhost:5502/api/menu/', // Alterado para a URL correta da sua API Spring Boot
    method: 'POST',
    dataType: 'json',
    contentType: 'application/json',
    data: JSON.stringify(newItem),
    success: function(data) {
      $('#create-form')[0].reset();
      const row = `
          <tr>
            <td>${data.id}</td>
            <td>${data.nome}</td>
            <td>${data.descricao}</td>
            <td>${data.preco}</td>
            <td>
              <button onclick="editItem(${data.id})" class="btn btn-sm btn-primary">Editar</button>
              <button onclick="deleteItem(${data.id})" class="btn btn-sm btn-danger">Excluir</button>
            </td>
          </tr>
        `;
      $('#menu-table tbody').append(row);
    }
  });
}

// Função para fazer uma requisição DELETE à API e excluir um item do menu
function deleteItem(id) {
  if (confirm('Tem certeza de que deseja excluir este item do menu?')) {
    $.ajax({
      url: `http://localhost:5502/api/menu/${id}`, // Alterado para a URL correta da sua API Spring Boot
      method: 'DELETE',
      success: function() {
        populateMenuTable();
      }
    });
  }
}

// Função para preencher o formulário de edição com os dados de um item do menu
function editItem(id) {
  $.ajax({
    url: `http://localhost:5502/api/menu/${id}`, // Alterado para a URL correta da sua API Spring Boot
    method: 'GET',
    dataType: 'json',
    success: function(item) {
      $('#nome').val(item.nome);
      $('#descricao').val(item.descricao);
      $('#preco').val(item.preco);
      
      // Cria um novo botão para atualizar o item
      const updateButton = `
        <button onclick="updateItem(${item.id})" class="btn btn-sm btn-primary">Atualizar</button>
      `;
      
      $('#create-form').append(updateButton);
    }
  });
}

// Função para fazer uma requisição PUT à API e atualizar um item do menu
function updateItem(id) {
  const nome = $('#nome').val();
  const descricao = $('#descricao').val();
  const preco = parseFloat($('#preco').val());
  
  const updatedItem = {
    nome: nome,
    descricao: descricao,
    preco: preco
  };
  
  $.ajax({
    url: `http://localhost:5502/api/menu/${id}`, // Alterado para a URL correta da sua API Spring Boot
    method: 'PUT',
    dataType: 'json',
    contentType: 'application/json',
    data: JSON.stringify(updatedItem),
    success: function() {
      $('#create-form')[0].reset();
      populateMenuTable();
    }
  });
}

// Preenche a tabela inicialmente e adiciona o evento de submit para adicionar um item
populateMenuTable();
$('#create-form').submit(addItem);

// Adiciona a funcionalidade de atualizar a lista ao clicar no botão "Listar"
$('#listar-button').click(populateMenuTable);

  </script>
</body>
</html>
